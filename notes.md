# Implementation Standards

## Chapter 3

Parties (entities) are

- Customer/Buyer: The invoice reciever
- Supplier/Seller: The invoice sender
- ZATCA

## Chapter 4

Validation Steps

1. Syntax Validation
   1. C14N & C14N11
   2. UBL2.1
   3. Mandatory Elements Presence
   4. Correct Data Types
2. Content Validation
   1. ISO EN16931 Rules
      1. Valid codes (currencies, countries, etc...)
      2. Mandatory Elements
      3. Logical Correlations (Calculations, total, etc...)
   2. CIUS (Core Invoice Usage Specifications) - Country Qualified Validation Rules

In conflict between standards, the priority will be

1. KSA Businsess Requirements
2. ISO EN16931
3. UBL

---

## Chapter 5

- Credit Note: Document from seller to buyer when buyer wants to return goods (I owe you money)
- Debit Note: Document from buyer to seller when buyer wants to return goods (you owe me money)

Notes (Credit or Debit) must refer to one or more existing invoice(s)

Invoice Indicators

- Third Party: The invoice is created by a third party
- Self Billed: The invoice is created by the buyer (allowed in B2B only, must be stated)
- Nominal: The invoice is issued for goods that are provided without consideration (for free) as per KSA VAT regulation
- Export: The invoice is issued to a foreign buyer as per KSA VAT regulation
- Summary: Invoice for multiple sales occured over a period of time (renting, maintenance, etc...)

## Chapter 7

Primitive Data Types

- Binary
- Date (ISO 8601 == YYYY-MM-DD)
- Decimal
- String

Sementic Data Types (Based on ISO 15000-5 standard), in XML invoice we will use only arabic numbers (0123456789). However, in visual invoices, we can use hindi numbers (٠١٢٣٤٥٦٧٨٩)

Component means the tag content or an attribute or the tag itself.

| No. | Business Term | Definition | Restriction | Component | Use | Premitive Type | Example |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | Amount | An amount states a numerical monetary value (without the currency) | Float rounded to 2 decimal places only | Content | Mandatory | Decimal | 10000.25 |
| 2 | Unit Price Amount | An amount states a numerical monetary value (without the currency) for 1 unit of a good | No restriction on rounding | Content | Mandatory | Decimal | 10000.25431 |
| 3 | Percentage | fractions of a hundred | No restriction on rounding | Content | Mandatory | Decimal | 34.2325 |
| 4 | Quantity | Number of product units | No restriction on rounding | Content | Mandatory | Decimal | 10000.24631 |
| 5 | Code | Standard codes | Same as code lists | Content | Mandatory | String | ABC123 |
| 6 | Identifiers (IDs) | Keys generated by any party | Using of correct information elements | Content/Scheme ID/Scheme Version ID | Content: Mandatory, Others: Conditional | String | Content: ABC:123-DEF, Scheme ID: GLN, Scheme Version ID: 1.0 |
| 7 | Date | Issue Date | Must not Contain Timezone | Content | Mandatory | Date | 2024-03-02 |
| 8 | Document Reference | Identifiers related to a party on the document, can be printed | `-` | Content | Mandatory | String | Allowence 5% when paying in advance |
| 9 | Text | Anything that can be written on the document | `-` | Content | Mandatory | String | Allowence 5% when paying in advance |
| 10 | Time | Time in `HH:mm:ss` format, we can use 24-hour format | if the system is in the same timezone of KSA, no need to append `Z` to the end of the time. Otherwise, append `Z` and write the time in UTC | Content | Mandatory | Time | 20:54:17 or 17:54:17Z |

[XML Invoice Order](http://www.datypic.com/sc/ubl21/e-ns39_Invoice.html)

## Chapter 8

### Vat Category Codes

- `S`: Standard VAT Value (15%)
- `Z`: Zero-rated Goods
- `E`: Exempted from VAT
- `O`: Not Subject to VAT

### Guidelines

- Each Invoice Line must have a VAT category code
- Each Invoice Line must have a VAT rate (except those with `O` vat code)
- Each document level allowance/charge must have a VAT rate & category code
- One VAT Breakdown shall be provided for each distinct combination of VAT category code and VAT rate
  - VAT rate can be found from the invoice line or from the document level allowance/charge
  - Only significant decimals in the rate will be considered
    - Example
    - Invoice line 1 has category code = S and VAT rate = 15
    - Invoice line 2 has category code = S and VAT rate = 15.00
    - This should result in only one VAT Breakdown.
- Invoice Total Vat Amount = sum(vat amount)

## Chapter 9

### Calculations

- Invoice totals can be in any currency
- Tax totals must be in SAR
- Invoice totals must include prices and aloowences seperetely

### Invocie Total Calcualtions

- Payable rounding amount is the adjustment needed to round the total payable amount into something payable (for example: if the `total invoice net amount = 869.58`, the `invoice total VAT amount` will equal `1000.02`, thus, the rounding amount will be `-0.02`)

| Term | XPath |
| --- | --- |
| Total invoice net amount | `/Invoice/cac:LegalMonetaryTotal/cbc:LineExtensionAmount` |
| Total allowances amount | `/Invoice/cac:LegalMonetaryTotal/cbc:AllowanceTotalAmount` |
| Total charges amount | `/Invoice/cac:LegalMonetaryTotal/cbc:ChargeTotalAmount` |
| Invoice total VAT amount | `/Invoice/cac:TaxTotal/cbc:TaxAmount` |
| Invoice total VAT amount in accounting currency | `/Invoice/cac:TaxTotal/cbc:TaxAmount` |
| Invoice total amount without VAT | `/Invoice/cac:LegalMonetaryTotal/cbc:TaxExclusiveAmount` |
| Invoice total amount with VAT | `/Invoice/cac:LegalMonetaryTotal/cbc:TaxInclusiveAmount` |
| Prepaid amount (advance payment) | `/Invoice/cac:LegalMonetaryTotal/cbc:PrepaidAmount` |
| Rounding amount | `/Invoice/cac:LegalMonetaryTotal/cbc:PayableRoundingAmount` |
| Amount due for payment | `/Invoice/cac:LegalMonetaryTotal/cbc:PayableAmount` |

### Invoice Line Calculations

| Name | Details | Formula | XPath |
| --- | --- | --- | --- |
| Item net price | Price after discount/charge and without vat | Item gross price − Item price discount | `/Invoice/cac:InvoiceLine/cac:Price/cbc:PriceAmount` |
| Invoice line net amount | The invoice line net amount without VAT, inclusive of line level allowance/charge | `Item line net amount = (~(Item net price/Item price base quantity) * Invoiced Quantity)~ − ~Invoice line allowance amount~ + ~Invoice line charge amount~` | `/Invoice/cac:InvoiceLine/cbc:LineExtensionAmount` |

The `~<Expression>~` means that the expression result must be rounded seperately first

Example

```xml
<cbc:InvoicedQuantity unitCode="PCE">10</cbc:InvoicedQuantity>
<cbc:LineExtensionAmount currencyID="SAR">925.00</cbc:LineExtensionAmount>
  <!--Code omitted for clarity-->
  <!--XML tags for Allowance (Discount)-->
<cac:AllowanceCharge>
<cbc:ChargeIndicator>false</cbc:ChargeIndicator>
<cbc:AllowanceChargeReasonCode>95</cbc:AllowanceChargeReasonCode>
<cbc:AllowanceChargeReason>Discount</cbc:AllowanceChargeReason>
   <cbc:Amount currencyID="SAR">100.00</cbc:Amount>
   </cac:AllowanceCharge>
      <!--XML tags for Charges-->
   <cac:AllowanceCharge>
      <cbc:ChargeIndicator>true</cbc:ChargeIndicator>
      <cbc:AllowanceChargeReasonCode>CG</cbc:AllowanceChargeReasonCode>
      <cbc:AllowanceChargeReason>Cleaning</cbc:AllowanceChargeReason>
      <cbc:Amount currencyID="SAR">25.00</cbc:Amount>
   </cac:AllowanceCharge>
   <!--Code omitted for clarity-->
   <cac:Price>
      <cbc:PriceAmount currencyID="SAR">100</cbc:PriceAmount>
      <cbc:BaseQuantity unitCode="PCE">1</cbc:BaseQuantity>
   </cac:Price>
```

Solution

```
Invoiced Quantity = 10
Discount Amount = SAR 100
Item net price = 100
Charge = 25
Base Quantity = 1

Formula:

Item line net amount = ~((Item net price/Item price base quantity) * Invoiced Quantity)~ − ~Invoice line allowance amount~ + ~Invoice line charge amount~

~((Item net price/Item price base quantity) * Invoiced Quantity)~ = (100/1)*10 = 1000
Invoice line allowance amount = 95
~Invoice line charge amount~
= 1000 - 95 + 25 = 930
```

Allowance Reason Codes

- 41: Bonus for works ahead of schedule
- 42: Other bonus
- 60: Manufacturer’s consumer discount
- 62: Due to military status
- 63: Due to work accident
- 64: Special agreement
- 65: Production error discount
- 66: New outlet discount
- 67: Sample discount
- 68: End-of-range discount
- 70: Incoterm discount
- 71: Point of sales threshold allowance
- 88: Material surcharge/deduction
- 95: Discount
- 100: Special rebate
- 102: Fixed long term
- 103: Temporary
- 104: Standard
- 105: Yearly turnover

Charge Reason Codes

- AA (Advertising): The service of providing advertising
- AAA (Telecommunication): The service of providing telecommunication activities and/or faclities
- AAC (Technical modification): The service of making technical modifications to a product
- AAD (Job-order production): The service of producing to order.
- AAE (Outlays): The service of providing money for outlays on behalf of a trading partner.
- AAF (Off-premises): The service of providing services outside the premises of the provider.
- AAH (Additional processing): The service of providing additional processing.
- AAI (Attesting) The service of certifying validity.
- AAS (Acceptance) The service of accepting goods or services.
- AAT (Rush delivery) The service to provide a rush delivery.
- AAV (Special construction) The service of providing special construction.
- AAY (Airport facilities) The service of providing airport facilities.
- AAZ (Concession) The service allowing a party to use another party's facilities.
- ABA (Compulsory storage) The service provided to hold a compulsory inventory.
- ABB (Fuel removal) Remove or off-load fuel from vehicle, vessel or craft.
- ABC (Into plane) Service of delivering goods to an aircraft from local storage.
- ABD (Overtime) The service of providing labour beyond the established limit of working hours.
- ABF (Tooling) The service of providing specific tooling.
- ABK (Miscellaneous) Miscellaneous services.
- ABL (Additional packaging) The service of providing additional packaging.
- ABN (Dunnage)
- [and many many others here...](https://docs.peppol.eu/poacc/billing/3.0/2023-Q2/codelist/UNCL7161/)

### Allowances and Charges Calculations

- Allowance/Charge can be fixed or percentage, if they are percentage so a base amount must be present

| Type | XPath |
| --- | --- |
| Percentage (from 0 to 100) | `/Invoice/cac:AllowanceCharge/cbc:MultiplierFactorNumeric` |
| Percentage Amount (Base amount \* percentage / 100) & Fixed Amount | `/Invoice/cac:AllowanceCharge/cbc:Amount` |

### Prepayment Amount Calculations

Prepaid Amount = Prepayment VAT Category Taxable Amount + Prepayment VAT Category Tax Amount

Parameters

- Prepayment ID
- Prepayment Issue Date
- Prepayment Issue Time
- Prepayment Document Type Code (Always 386)

Guidelines

- Prepayment adds a new invoice line with VAT, item net price, line with VAT all set to 0

```xml
<!--Adjustment of prepayment amount-->
<cac:LegalMonetaryTotal>
   <cbc:LineExtensionAmount currencyID="SAR">200</cbc:LineExtensionAmount>
   <cbc:TaxExclusiveAmount currencyID="SAR">200</cbc:TaxExclusiveAmount>
   <cbc:TaxInclusiveAmount currencyID="SAR">230</cbc:TaxInclusiveAmount>
   <cbc:PrepaidAmount currencyID="SAR">100</cbc:PrepaidAmount>
   <cbc:PayableAmount currencyID="SAR">130</cbc:PayableAmount>
</cac:LegalMonetaryTotal>

<!--Additional invoice line for prepayment amount adjustment-->
<cac:InvoiceLine>
   <cbc:ID>2</cbc:ID>
   <cbc:InvoicedQuantity unitCode="PCE">0.00</cbc:InvoicedQuantity>
   <cbc:LineExtensionAmount currencyID="SAR">0.00</cbc:LineExtensionAmount>

<!--document reference of the prepayment invoice-->
   <cac:DocumentReference>
      <cbc:ID>46531</cbc:ID>
      <cbc:IssueDate>2021-07-31</cbc:IssueDate>
      <cbc:IssueTime>12:28:17</cbc:IssueTime>
      <cbc:DocumentTypeCode>386</cbc:DocumentTypeCode>
   </cac:DocumentReference>

   <cac:TaxTotal>
      <cbc:TaxAmount currencyID="SAR">0.00</cbc:TaxAmount>
      <cbc:RoundingAmount currencyID="SAR">0.00</cbc:RoundingAmount>

      <!--breakdown of the prepayment amount -->
      <cac:TaxSubtotal>
         <cbc:TaxableAmount currencyID="SAR">86.96</cbc:TaxableAmount>
         <cbc:TaxAmount currencyID="SAR">13.04</cbc:TaxAmount>
         <cac:TaxCategory>
            <cbc:ID>S</cbc:ID>
            <cbc:Percent>15.00</cbc:Percent>
            <cac:TaxScheme>
               <cbc:ID>VAT</cbc:ID>
            </cac:TaxScheme>
         </cac:TaxCategory>
      </cac:TaxSubtotal>
   </cac:TaxTotal>

   <cac:Item>
      <cbc:Name>Prepayment adjustment</cbc:Name>
      <cac:ClassifiedTaxCategory>
         <cbc:ID>S</cbc:ID>
         <cbc:Percent>15</cbc:Percent>
         <cac:TaxScheme>
            <cbc:ID>VAT</cbc:ID>
         </cac:TaxScheme>
      </cac:ClassifiedTaxCategory>
   </cac:Item>

   <cac:Price>
      <cbc:PriceAmount currencyID="SAR">0.00</cbc:PriceAmount>
   </cac:Price>
</cac:InvoiceLine>
```

Another example with payment amount adjustments

```xml
<!--Adjustment of prepayment amount-->
<cac:LegalMonetaryTotal>
   <cbc:LineExtensionAmount currencyID="SAR">200</cbc:LineExtensionAmount>
   <cbc:TaxExclusiveAmount currencyID="SAR">200</cbc:TaxExclusiveAmount>
   <cbc:TaxInclusiveAmount currencyID="SAR">230</cbc:TaxInclusiveAmount>
   <cbc:PrepaidAmount currencyID="SAR">104</cbc:PrepaidAmount>
   <cbc:PayableAmount currencyID="SAR">126</cbc:PayableAmount>
</cac:LegalMonetaryTotal>

<!--Additional invoice line # 2 for prepayment amount adjustment-->
<cac:InvoiceLine>
   <cbc:ID>2</cbc:ID>
   <cbc:InvoicedQuantity unitCode="PCE">0.00</cbc:InvoicedQuantity>
   <cbc:LineExtensionAmount currencyID="SAR">0.00</cbc:LineExtensionAmount>

   <!--document reference of the prepayment invoice-->
   <cac:DocumentReference>
      <cbc:ID>46531</cbc:ID>
      <cbc:IssueDate>2021-07-31</cbc:IssueDate>
      <cbc:IssueTime>12:28:17</cbc:IssueTime>
      <cbc:DocumentTypeCode>386</cbc:DocumentTypeCode>
   </cac:DocumentReference>

   <cac:TaxTotal>
      <cbc:TaxAmount currencyID="SAR">0.00</cbc:TaxAmount>
      <cbc:RoundingAmount currencyID="SAR">0.00</cbc:RoundingAmount>

      <!--breakdown of the prepayment amount -->
      <cac:TaxSubtotal>
         <cbc:TaxableAmount currencyID="SAR">40.00</cbc:TaxableAmount>
         <cbc:TaxAmount currencyID="SAR">0.00</cbc:TaxAmount>
         <cac:TaxCategory>
            <cbc:ID>E</cbc:ID>
            <cbc:Percent>0.00</cbc:Percent>
            <cac:TaxScheme>
               <cbc:ID>VAT</cbc:ID>
            </cac:TaxScheme>
         </cac:TaxCategory>
      </cac:TaxSubtotal>
   </cac:TaxTotal>

   <cac:Item>
      <cbc:Name>Prepayment adjustment</cbc:Name>
      <cac:ClassifiedTaxCategory>
         <cbc:ID>E</cbc:ID>
         <cbc:Percent>0.00</cbc:Percent>
         <cac:TaxScheme>
            <cbc:ID>VAT</cbc:ID>
         </cac:TaxScheme>
      </cac:ClassifiedTaxCategory>
   </cac:Item>

   <cac:Price>
      <cbc:PriceAmount currencyID="SAR">0.00</cbc:PriceAmount>
   </cac:Price>
</cac:InvoiceLine>

<!--Additional invoice line #3 for prepayment amount adjustment-->
<cac:InvoiceLine>
   <cbc:ID>3</cbc:ID>
   <cbc:InvoicedQuantity unitCode="PCE">0.00</cbc:InvoicedQuantity>
   <cbc:LineExtensionAmount currencyID="SAR">0.00</cbc:LineExtensionAmount>

   <!--document reference of the prepayment invoice-->
   <cac:DocumentReference>
      <cbc:ID>465334341</cbc:ID>
      <cbc:IssueDate>2022-07-31</cbc:IssueDate>
      <cbc:IssueTime>12:29:17</cbc:IssueTime>
      <cbc:DocumentTypeCode>386</cbc:DocumentTypeCode>
   </cac:DocumentReference>

   <cac:DocumentReference>
      <cbc:ID>765334</cbc:ID>
      <cbc:IssueDate>2020-07-31</cbc:IssueDate>
      <cbc:IssueTime>12:22:17</cbc:IssueTime>
      <cbc:DocumentTypeCode>386</cbc:DocumentTypeCode>
   </cac:DocumentReference>

   <cac:TaxTotal>
      <cbc:TaxAmount currencyID="SAR">0.00</cbc:TaxAmount>
      <cbc:RoundingAmount currencyID="SAR">0.00</cbc:RoundingAmount>

      <!--breakdown of the prepayment amount -->
      <cac:TaxSubtotal>
         <cbc:TaxableAmount currencyID="SAR">10.00</cbc:TaxableAmount>
         <cbc:TaxAmount currencyID="SAR">1.50</cbc:TaxAmount>
         <cac:TaxCategory>
            <cbc:ID>S</cbc:ID>
            <cbc:Percent>15.00</cbc:Percent>
            <cac:TaxScheme>
               <cbc:ID>VAT</cbc:ID>
            </cac:TaxScheme>
         </cac:TaxCategory>
      </cac:TaxSubtotal>
   </cac:TaxTotal>

   <cac:Item>
      <cbc:Name>Prepayment adjustment</cbc:Name>
      <cac:ClassifiedTaxCategory>
         <cbc:ID>S</cbc:ID>
         <cbc:Percent>15.00</cbc:Percent>
         <cac:TaxScheme>
            <cbc:ID>VAT</cbc:ID>
         </cac:TaxScheme>
      </cac:ClassifiedTaxCategory>
   </cac:Item>

   <cac:Price>
      <cbc:PriceAmount currencyID="SAR">0.00</cbc:PriceAmount>
   </cac:Price>
</cac:InvoiceLine>

<!--Additional invoice line #4 for prepayment amount adjustment-->
<cac:InvoiceLine>
   <cbc:ID>4</cbc:ID>
   <cbc:InvoicedQuantity unitCode="PCE">0.00</cbc:InvoicedQuantity>
   <cbc:LineExtensionAmount currencyID="SAR">0.00</cbc:LineExtensionAmount>
   <!--document reference of the prepayment invoice-->
   <cac:DocumentReference>
      <cbc:ID>86531</cbc:ID>
      <cbc:IssueDate>2019-02-31</cbc:IssueDate>
      <cbc:IssueTime>12:29:37</cbc:IssueTime>
      <cbc:DocumentTypeCode>386</cbc:DocumentTypeCode>
   </cac:DocumentReference>

   <cac:TaxTotal>
      <cbc:TaxAmount currencyID="SAR">0.00</cbc:TaxAmount>
         <cbc:RoundingAmount currencyID="SAR">0.00</cbc:RoundingAmount>
         <!--breakdown of the prepayment amount -->
         <cac:TaxSubtotal>
            <cbc:TaxableAmount currencyID="SAR">50.00</cbc:TaxableAmount>
            <cbc:TaxAmount currencyID="SAR">2.5</cbc:TaxAmount>
            <cac:TaxCategory><cbc:ID>S</cbc:ID> (8)<cbc:Percent>5.00</cbc:Percent>
            <cac:TaxScheme>
               <cbc:ID>VAT</cbc:ID>
            </cac:TaxScheme>
         </cac:TaxCategory>
      </cac:TaxSubtotal>
   </cac:TaxTotal>

   <cac:Item>
      <cbc:Name>Prepayment adjustment</cbc:Name>
      <cac:ClassifiedTaxCategory>
         <cbc:ID>S</cbc:ID><cbc:Percent>5.00</cbc:Percent>
         <cac:TaxScheme>
            <cbc:ID>VAT</cbc:ID>
         </cac:TaxScheme>
      </cac:ClassifiedTaxCategory>
   </cac:Item>

   <cac:Price>
      <cbc:PriceAmount currencyID="SAR">0.00</cbc:PriceAmount>
   </cac:Price>
</cac:InvoiceLine>
```

### VAT Calculation

- VAT Category Taxable Amount = Sum(invoice line net amount) + document level charge amount - document level allowance amount
- VAT Category Tax Amount = VAT Category Taxable Amount \* VAT rate

Example

```xml
<!--Charge on document level -->
<cac:AllowanceCharge>
   <cbc:ChargeIndicator>true</cbc:ChargeIndicator>
   <cbc:AllowanceChargeReasonCode>CG</cbc:AllowanceChargeReasonCode>
   <cbc:AllowanceChargeReason>Cleaning</cbc:AllowanceChargeReason>
   <cbc:Amount currencyID="SAR">200</cbc:Amount>
   <cac:TaxCategory>
      <cbc:ID>S</cbc:ID>
      <cbc:Percent>15</cbc:Percent>
      <cac:TaxScheme>
         <cbc:ID>VAT</cbc:ID>
      </cac:TaxScheme>
   </cac:TaxCategory>
</cac:AllowanceCharge>

<!--Allowance on document level -->
<cac:AllowanceCharge>
   <cbc:ChargeIndicator>false</cbc:ChargeIndicator>
   <cbc:AllowanceChargeReasonCode>95</cbc:AllowanceChargeReasonCode>
   <cbc:AllowanceChargeReason>Discount</cbc:AllowanceChargeReason>
   <cbc:Amount currencyID="SAR">100</cbc:Amount>
   <cac:TaxCategory>
      <cbc:ID>S</cbc:ID>
      <cbc:Percent>15</cbc:Percent>
      <cac:TaxScheme>
         <cbc:ID>VAT</cbc:ID>
      </cac:TaxScheme>
   </cac:TaxCategory>
</cac:AllowanceCharge>

<!--VAT breakdown -->
<cac:TaxTotal>
   <cbc:TaxAmount currencyID="SAR">885</cbc:TaxAmount>
   <cac:TaxSubtotal>
      <cbc:TaxableAmount currencyID="SAR">5900</cbc:TaxableAmount>
      <cbc:TaxAmount currencyID="SAR">885</cbc:TaxAmount>
      <cac:TaxCategory>
         <cbc:ID>S</cbc:ID>
         <cbc:Percent>15</cbc:Percent>
         <cac:TaxScheme>
            <cbc:ID>VAT</cbc:ID>
         </cac:TaxScheme>
      </cac:TaxCategory>
   </cac:TaxSubtotal>

   <cac:TaxSubtotal>
      <cbc:TaxableAmount currencyID="SAR">3000</cbc:TaxableAmount>
      <cbc:TaxAmount currencyID="SAR">0</cbc:TaxAmount>
      <cac:TaxCategory>
         <cbc:ID>E</cbc:ID>
         <cbc:Percent>0</cbc:Percent>
         <cbc:TaxExemptionReason>Reason for tax exempt</cbc:TaxExemptionReason>
         <cac:TaxScheme>
            <cbc:ID>VAT</cbc:ID>
         </cac:TaxScheme>
      </cac:TaxCategory>
   </cac:TaxSubtotal>
</cac:TaxTotal>

<!--Invoice line with VAT 15% -->
<cac:InvoiceLine>
   <cbc:ID>1</cbc:ID>
   <cbc:Note>Testing note on line level</cbc:Note>
   <cbc:InvoicedQuantity unitCode="PCE">10</cbc:InvoicedQuantity>
   <cbc:LineExtensionAmount currencyID="SAR">5000.00</cbc:LineExtensionAmount>
   <!--code omitted for clarity -->
   <cac:ClassifiedTaxCategory>
      <cbc:ID>S</cbc:ID>
      <cbc:Percent>15.00</cbc:Percent>
      <cac:TaxScheme>
         <cbc:ID>VAT</cbc:ID>
      </cac:TaxScheme>
   </cac:ClassifiedTaxCategory>
   <!--Invoice line with VAT 0% -->
   <cac:InvoiceLine>
      <cbc:ID>2</cbc:ID>
      <cbc:InvoicedQuantity unitCode="PCE">10</cbc:InvoicedQuantity>
      <cbc:LineExtensionAmount currencyID="SAR">3000.00</cbc:LineExtensionAmount>
      <!--code omitted for clarity -->
      <cac:ClassifiedTaxCategory>
         <cbc:ID>E</cbc:ID>
         <cbc:Percent>0.0</cbc:Percent>
         <cac:TaxScheme>
            <cbc:ID>VAT</cbc:ID>
         </cac:TaxScheme>
      </cac:ClassifiedTaxCategory>

      <!--Invoice line with VAT 15% -->
      <cac:InvoiceLine>
         <cbc:ID>3</cbc:ID>
         <cbc:InvoicedQuantity unitCode="PCE">10</cbc:InvoicedQuantity>
         <cbc:LineExtensionAmount currencyID="SAR">800.00</cbc:LineExtensionAmount>
         <!--code omitted for clarity -->
         <cac:ClassifiedTaxCategory>
            <cbc:ID>S</cbc:ID>
            <cbc:Percent>15.00</cbc:Percent>
            <cac:TaxScheme>
               <cbc:ID>VAT</cbc:ID>
            </cac:TaxScheme>
         </cac:ClassifiedTaxCategory>
```

## Chapter 10

Rounding Rules

- All document level totals shall be rounded to two decimals for accounting
- Rounding shall be done on the final calculation results not on any intermediate results
- VAT category tax amount (BT-110) shall be rounded on document level and not as a summation of rounded Invoice line VAT amounts

## Chapter 11

VAT Categories Code

- S: Standard
- E: Exempted from VAT (Financial services mentioned in Article 29 of the VAT Regulations, Life insurance services mentioned in Article 29 of the VAT Regulations, Real estate transactions mentioned in Article 30 of the VAT Regulations)
- Z: Zero VAT (The international transport of Goods &/or Passengers, services directly connected and incidental to a Supply of international passenger transport, Supply of a qualifying means oftransport, Any services relating to Goods or passenger transportation, as defined in article twenty five of these Regulations, Medicines and medical equipment, Qualifying metals, Private education to citizen, Private healthcare to citizen, supply of qualified military goods)
- O: Not Subjected to VAT (Reason is free text, to be provided by the taxpayer on case to case basis)

Payment Means Type Code

- 10: Cash
- 20: Cheque
- 54: Credit Card
- 55: Debit Card

[Access the full list of codes](https://unece.org/fileadmin/DAM/trade/untdid/d16b/tred/tred4461.htm)

## Chapter 13

### Rules

The following fields are mandatory in the invoice

| Field | XPath |
| --- | --- |
| Invoice Reference Number (IRN) | `/Invoice/cbc:ID` |
| Issue Time | `/Invoice/cbc:IssueDate` |
| Invoice Type Code | `/Invoice/cbc:InvoiceTypeCode` |
| Invoice Currency Code | `/Invoice/cbc:DocumentCurrencyCode` |
| Seller Name | `/Invoice/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:RegistrationName` |
| Seller Postal Address | `/Invoice/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress` |
| Seller Country Code (in the postal address) | `/Invoice/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cac:Country/cbc:IdentificationCode` |
| `*`Buyer Postal Address (only for B2B invoices) | `/Invoice/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress` |
| Invoice Total With & Without VAT | `/Invoice/cac:LegalMonetaryTotal/cbc:TaxInclusiveAmount` (`cbc:TaxExclusiveAmount`) |
| Amount Due | `/Invoice/cac:LegalMonetaryTotal/cbc:PayableAmount` |
| At least one invoice line | `/Invoice/cac:InvoiceLine` |
| Invoice Line Identifier | `/Invoice/cac:InvoiceLine/cbc:ID` |
| Invoice Line Invoiced Quantity | `/Invoice/cac:InvoiceLine/cbc:InvoicedQuantity` |
| Invoice Line Net Amount | `/Invoice/cac:InvoiceLine/cbc:LineExtensionAmount` |
| Invoice Line Item Name | `/Invoice/cac:InvoiceLine/cac:Item/cbc:Name` |
| Item Net Price | `/Invoice/cac:InvoiceLine/cac:Price/cbc:PriceAmount` |
| Document Level Allowance/Charge (if any) | `/Invoice/cac:AllowanceCharge/cbc:Amount` |
| VAT Category Code for Document Level Allowance/Charge (if any) | `/ubl:Invoice/cac:AllowanceCharge/cac:TaxCategory/cbc:ID` |
| VAT Breakdown (Code, taxable amount, tax amount, percentage) | `/Invoice/cac:TaxTotal/cac:TaxSubtotal/` |
| Payment Means Type Code | `/Invoice/cac:PaymentMeans/cbc:PaymentMeansCode` |
| Total VAT Amount in Accounting Currency (if VAT Currency code exists) | `/Invoice/cac:TaxTotal/cbc:TaxAmount` (the small block) |
| Preceding Invoice Reference (for credit & debit notes) | `/Invoice/cac:BillingReference/cac:InvoiceDocumentReference/cbc:ID` |

and many other rules...

Invoice Type Code is found at `/Invoice/cbc:InvoiceTypeCode/@name` and it's a 7-digit Code following the pattern `NNPNESB`, where

- `NN`: Invoice Subtype (`01` for B2B, `02` for B2C)
- `P`: Is the invoice a 3rd party invoice? (`0` for false, `1` for true)
- `N`: Is the invoice a nominal invoice? (`0` for false, `1` for true)
- `E`: Is the invoice an export invoice? (`0` for false, `1` for true)
- `S`: Is the invoice a summary invoice? (`0` for false, `1` for true)
- `B`: Is the invoice a self billed invoice? (`0` for false, `1` for true)

Invoices can't be self billed and export at the same time

### Party Legal Entities

Party Legal Entity is a part of the Party Information. Party Information include

- Seller Party Identification (Additional ID) is always required, and it can be
  - Commercial Registration Number (CRN)
  - MOMRAH License (MOM)
  - MHRSD License (MLS)
  - 700 Number (700)
  - MISA License (SAG)
  - Other (OTH)
- Buyer Party Identification (required only for B2B if the buyer is not VAT registered)
  - Tax Identification Number (TIN)
  - Commercial registration number (CRN)
  - MOMRAH license (MOM)
  - MHRSD license (MLS)
  - 700 Number (700)
  - MISA license (SAG)
  - National ID (NAT)
  - GCC ID (GCC)
  - Iqama Number (IQA)
  - Passport ID (PAS)
  - Other ID (OTH)

## Chapter 14

- Invocie File Name must follow this pattern (vatNumber_yyyymmddThhmmss_IRN)
  - Example: 312345678901233_20240306T234032_SME0231